{% extends 'base.html' %}

{% block title %}Dodaj przychód{% endblock %}

{% block head %}
    {{ parent() }}        
{% endblock %}

{% block header %}
    {{ parent() }}
{% endblock %}

{% block content %} 
    <main>
        <article>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <header>
                            <p class="h4 font-weight-bold text-uppercase ml-0 mb-4 mt-5 text-center text-md-left">Ustawienia </p>
                        </header>

                        <div class="col-10 bg-light p-1 m-1 mx-auto d-block  text-center settingsItem" id="incomeCategoryMenu">
                            <p class = "d-inline" >
                                <i class = "icon-money"></i>
                                Kategorie przychodów 
                            </p>
                            <i id="incomeCategoryIcon" class = "d-inline icon-down-dir ps-auto" style="float:right"></i>
                        </div>

                        <div class="col-10 m-3 mx-auto" style="display:none" id="incomeCategory">    
                            <section>    
                                {# <div class="col p-1 mb-1 mx-auto d-block ps-3 addNewCategory" id="addIncome"> #}
                                    {# <p class = "d-inline">
                                        Nowa kategoria
                                    </p> #}
                                     <!-- Button trigger modal -->
                                <button type="button" class="btn col-12 p-1 mb-1 mx-auto d-block ps-3 addNewCategory" id="addIncome" data-bs-toggle="modal" data-bs-target="#exampleModal">
                                    Nowa kategoria<i id="incomeAddIcon" class = "d-inline icon-plus pe-3" style="float:right"></i>
                                </button>
                                    
                                {# </div> #}

                                {% for row in incomeCategories %}
                                    <div class="col bg-light p-1 mb-1 mx-auto d-block ps-3">
                                        <p class = "d-inline" >
                                            {{row['name']}} 
                                            {% set id_catInc =row['id'] %} 
                                        </p>

                                        <form method="post" action="settings/deleteIncomeCategory" enctype="multipart/form-data" id="formCatInc{{ row['id'] }}" class = "d-inline" style="float:right"> 
                                            <input name="incomeCategoryItem" id="categoryIncomeItem{{ row['id'] }}" value="{{ row['id'] }}" style="display: none"></input>
                                            <i id="incomeTrashIcon" class = "icon-trash-empty pe-3"
                                             onclick="document.getElementById('formCatInc{{ id_catInc }}').submit()" > </i> 
    
                                            <input type="submit" class="bg-transparent" style="display: none"></input>
                                        </form>

                                        <i id="incomeEditIcon" class = "d-inline icon-edit pe-1" style="float:right"></i>
                                        
                                        <p class="text-muted m-0 p-0">
                                            <small>Limit: BRAK</small>
                                        </p>
                                    </div>
                                {% endfor %}
                          
                                <!-- Modal -->
                                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title fw-bold" id="exampleModalLabel" style="color:#4db6ac;">
                                                Dodaj nową kategorie przychodu
                                                </h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                                </button>
                                            </div>
                                            <form method="post" action="settings/addIncomeCategory" id="modalIncomeForm" enctype="multipart/form-data" >
                                                <div class="modal-body" style="color:#4db6ac;">
                                                    <div class="form-group">
                                                        <label for="inputIncCategory">Nazwa Kategorii</label>
                                                        <input id="inputIncomeCategoryiD" type="text" class="form-control col-10" name="inputIncomeCategory" autofocus required />
                                  
                                                    </div>
                                                </div>
                                                <div class="col-12 modal-footer text-center mx-auto d-block">

                                                    <button type="submit" class="btn col-5 " id='buttonSave' style="background-color:#4db6ac; color:white">Zapisz
                                                    </button>
                                                    <button type="button" class="btn btn-secondary col-5" data-bs-dismiss="modal">Anuluj</button>
                                                </div>
                                            </form>        
                                        </div>
                                    </div>
                                </div>
                            </section>  
                        </div> 

                        <div class="col-10 bg-light p-1 m-1 mx-auto d-block text-center settingsItem" id="expenseCategoryMenu">  
                            <p class = "d-inline" >
                                <i class = "icon-basket"></i>
                                Kategorie wydatków 
                            </p>
                            <i id="expenseCategoryIcon" class = "d-inline icon-down-dir ps-auto" style="float:right"></i>
                        </div>

                        <div class="col-10 m-3 mx-auto" style="display:none" id="expenseCategory">    
                            <section>    
                                {# <div class="col p-1 mb-1 mx-auto d-block ps-3 addNewCategory">
                                    <p class = "d-inline">
                                        Nowa kategoria
                                    </p> #}

                                    <button type="button" class="btn col-12 p-1 mb-1 mx-auto d-block ps-3 addNewCategory" id="addExpense" data-bs-toggle="modal" data-bs-target="#expenseModal">
                                        Nowa kategoria<i id="expenseAddIcon" class = "d-inline icon-plus pe-3" style="float:right"></i>
                                    </button>

                                {# </div> #}
                                {% for row in expenseCategories %}
                                    <div class="col bg-light p-1 mb-1 mx-auto d-block">
                                        <p class = "d-inline" >
                                            {{row['name']}}
                                            {% set id_catExp =row['id'] %} 
                                        </p>

                                        <form method="post" action="settings/deleteExpenseCategory" enctype="multipart/form-data" id="formCatExp{{ row['id'] }}" class = "d-inline" style="float:right"> 
                                                <input name="expenseCategoryItem" id="categoryExpenseItem{{ row['id'] }}" value="{{ row['id'] }}" style="display: none"></input>
                                                <i id="expenseTrashIcon" class = "icon-trash-empty pe-3"
                                                 onclick="document.getElementById('formCatExp{{ id_catExp }}').submit()" > </i> 
        
                                                <input type="submit" class="bg-transparent" style="display: none"></input>
                                        </form>

                                        
                                        <i id="expenseEditIcon" class = "d-inline icon-edit pe-1" style="float:right"></i>
                                        <p class="text-muted m-0 p-0">
                                            <small>Limit: BRAK</small>
                                        </p>
                                    </div>
                                {% endfor %}
                                <!-- Modal -->
                                <div class="modal fade" id="expenseModal" tabindex="-1" aria-labelledby="expenseModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title fw-bold" id="expenseModalLabel" style="color:#4db6ac;">
                                                Dodaj nową kategorie wydatku
                                                </h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                                </button>
                                            </div>
                                            <form method="post" action="settings/addExpenseCategory" id="modalExpenseForm" enctype="multipart/form-data" >
                                                <div class="modal-body" style="color:#4db6ac;">
                                                    <div class="form-group">
                                                        <label for="inputExpCategory">Nazwa Kategorii</label>
                                                        <input id="inputExpenseCategoryiD" type="text" class="form-control col-10" name="inputExpenseCategory" autofocus required />
                                                        <div class="checkbox">
                                                            <label class="h6 mx-auto d-block mb-md-3 mt-md-2 mt-sm-1 mb-sm-1 ">
                                                            <input type="checkbox"  name="limit" id="ExpenseLimit" class=""/> Włącz limit dla kategorii
                                                            </label>
                                                         </div>

                                                        <div class = "form-group row pb-3" >
                                                            <label for ="kwota" class="h6 col-form-label d-block"> Ustaw miesięczny limit wydatków dla kategorii</label>
                                                            <div class="col-10">
                                                                <input type="number" class="form-control col-sm-2" name= "amount" id="amount" min="0" step="0.01" disabled>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-12 modal-footer text-center mx-auto d-block">

                                                    <button type="submit" class="btn col-5 " id='buttonSave' style="background-color:#4db6ac; color:white">Zapisz
                                                    </button>
                                                    <button type="button" class="btn btn-secondary col-5" data-bs-dismiss="modal">Anuluj</button>
                                                </div>
                                            </form>        
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col-10 bg-light p-1 m-1 mx-auto d-block text-center settingsItem" id="paymentsMenu">
                            <p class = "d-inline" >
                                <i class = "icon-money-1"></i>
                                Sposoby płatności 
                            </p>
                            <i id="paymentsIcon" class =  "d-inline icon-down-dir ps-auto" style="float:right"></i>
                        </div>

                        <div class="col-10 m-3 mx-auto" style="display:none" id="payments">    
                            <section>
                                <div class="col p-1 mb-1 mx-auto d-block ps-3 addNewCategory">
                                    <p class = "d-inline">
                                        Nowa kategoria
                                    </p>
                                    <i id="incomeAddIcon" class = "d-inline icon-plus pe-3" style="float:right"></i>
                                </div>    
                                {% for row in payments %}
                                    <div class="col bg-light p-1 mb-1 mx-auto d-block">
                                        <p class = "d-inline" >
                                            {{row['name']}} 
                                            {% set id_catPay = row['id'] %}
                                        </p>

                                        <form method="post" action="settings/deletePaymentCategory" enctype="multipart/form-data" id="formCatPay{{ row['id'] }}" class = "d-inline" style="float:right"> 
                                            <input name="paymentCategoryItem" id="categoryPaymentItem{{ row['id'] }}" value="{{ row['id'] }}" style="display: none"></input>
                                            <i id="paymentsTrashIcon" class = "icon-trash-empty pe-3"
                                             onclick="document.getElementById('formCatPay{{ id_catPay }}').submit()" > </i> 
    
                                            <input type="submit" class="bg-transparent" style="display: none"></input>
                                        </form>

                                        <i id="paymentsEditIcon" class = "d-inline icon-edit pe-1" style="float:right"></i>
                                        <p class="text-muted m-0 p-0">
                                            <small>Limit: BRAK</small>
                                        </p>
                                    </div>
                                {% endfor %}
                            </section>
                        </div>

                        <div class="col-10 bg-light p-1 m-1 mx-auto d-block text-center settingsItem" id="profileMenu">
                            <p class = "d-inline" >
                                <i class = "icon-user-male" ></i>
                                Profil użytkowika 
                            </p>
                            <i id="profileIcon" class =  "d-inline icon-down-dir ps-auto" style="float:right"></i>
                        </div>

                        <div id="profile" style="display:none">
                            <dl class="row mt-5 col-11">
                                <dt class="col-5 text-end ms-3 ">Name: </dt>
                                <dd class="col-5 ps-3">{{ user.name }}</dd>
                                <dt class="col-5 text-end ms-3">email: </dt>
                                <dd class="col-5 ps-3">{{ user.email }} </dd>
            
                                <dl class=" text-center ">
                                    <form method="post" action="profile-edit"> 
                                        <button type="submit" class="col-8 col-md-3 btn btn-outline-success mt-4">Edytuj</button>
                                    </form>
                                </dl>
                            </dl>

                        </div>
                        
                            
                    </div>
                </div>
            </div>
        </article>
    </main>

{% endblock %}

{% block footer %}
    {{ parent() }}
    <script src="/js/settings.js"></script>
    <script src="/js/settingsModal.js"></script>
{% endblock %}